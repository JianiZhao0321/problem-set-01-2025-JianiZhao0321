<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jiani">

<title>Text as Data: Problem Set 01</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="problem_set_01_Jiani_files/libs/clipboard/clipboard.min.js"></script>
<script src="problem_set_01_Jiani_files/libs/quarto-html/quarto.js"></script>
<script src="problem_set_01_Jiani_files/libs/quarto-html/popper.min.js"></script>
<script src="problem_set_01_Jiani_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="problem_set_01_Jiani_files/libs/quarto-html/anchor.min.js"></script>
<link href="problem_set_01_Jiani_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="problem_set_01_Jiani_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="problem_set_01_Jiani_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="problem_set_01_Jiani_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="problem_set_01_Jiani_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Text as Data: Problem Set 01</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jiani </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="instructions" class="level2">
<h2 class="anchored" data-anchor-id="instructions">Instructions</h2>
<p>To complete this homework, you have two options.</p>
<p>You can either complete this assignment using a <strong>dataset of your choice</strong>. This is a great opportunity for you to start working with a dataset that you can potentially use for your final project.</p>
<p>Your second option is to this dataset of social media posts from political candidates running for Congress during the 2022 U.S. Midterm election.</p>
<p>You can download the dataset <a href="https://www.dropbox.com/scl/fi/jz14130dlzj5xvca9txj4/midterm_candidates_labeled_all_May05.csv?rlkey=b0m1h6kk1af3uz9tjqyelthh3&amp;dl=0">here</a></p>
<p>To know more about the dataset, read and cite this paper: <a href="https://journals.sagepub.com/doi/full/10.1177/20563051251337541" class="uri">https://journals.sagepub.com/doi/full/10.1177/20563051251337541</a></p>
<p>If you want say thanks to the people who collected and shared this data with us for this class, please send a email to my colleague <a href="https://maggiegmacdonald.com/">Maggie MacDonald</a></p>
<p><strong>IMPORTANT:</strong> Remember to NOT commit your data to github. Github does not allow you to push large datasets to remote repositories. If you commit your dataset, you will need to reset your commit, and that’s always a bit of work. In addition, remember that your notebook should be compiled with the results of the code blocks.</p>
</section>
<section id="question-1" class="level2">
<h2 class="anchored" data-anchor-id="question-1">Question 1 ———————————————</h2>
<p>Take a small a sample of your documents and read them carefully. This sample doesn’t need to be random. Select cases that are more interesting, and close to your theoretical interest in this dataset. What are you thoughts about these documents? What did you learn after reading them?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Package version: 4.3.1
Unicode version: 14.0
ICU version: 71.1
Parallel computing: disabled
See https://quanteda.io for tutorials and examples.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(preText)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>preText: Diagnostics to Assess the Effects of Text Preprocessing Decisions
Version 0.7.2 created on 2021-07-25.
copyright (c) 2021, Matthew J. Denny, Georgetown University
                    Arthur Spirling, NYU
Type vignette('getting_started_with_preText') to get started.
Development website: https://github.com/matthewjdenny/preText</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the speech file</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ecb_speeches <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"~/Dev/PPOL6081/fraccaroli_arel-bundock_blyth_replication_20250523/data/all_ECB_speeches_20240426.csv"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">delim =</span> <span class="st">"|"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One or more parsing issues, call `problems()` on your data frame for details,
e.g.:
  dat &lt;- vroom(...)
  problems(dat)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 2781 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: "|"
chr  (4): speakers, title, subtitle, contents
date (1): date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show first rows</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ecb_speeches)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  date       speakers          title                           subtitle contents
  &lt;date&gt;     &lt;chr&gt;             &lt;chr&gt;                           &lt;chr&gt;    &lt;chr&gt;   
1 2024-03-27 Frank Elderson    Taking into account climate an… Remarks… "  SPEE…
2 2024-03-27 Piero Cipollone   The confidence to act: monetar… Speech … "  SPEE…
3 2024-03-22 Philip R. Lane    Inflation and monetary policy   Slides …  &lt;NA&gt;   
4 2024-03-20 Isabel Schnabel   R(ising) star?                  Speech … "  SPEE…
5 2024-03-20 &lt;NA&gt;              Debate on: Is the inflation su… Slides …  &lt;NA&gt;   
6 2024-03-20 Christine Lagarde Building confidence in the pat… Speech … "  SPEE…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># detect the speeches related to poverty and inequality</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>poverty_speeches <span class="ot">&lt;-</span> ecb_speeches <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(contents, <span class="fu">regex</span>(<span class="st">"poverty|inequality|deprivation|income distribution|social inclusion"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">str_detect</span>(title, <span class="fu">regex</span>(<span class="st">"poverty|inequality|deprivation|income distribution|social inclusion"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>         <span class="fu">str_detect</span>(subtitle, <span class="fu">regex</span>(<span class="st">"poverty|inequality|deprivation|income distribution|social inclusion"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>I selected three speeches — by Cipollone (2024), Schnabel (2023), and Lagarde (2022) — because they directly engage with themes of wages, living standards, and vulnerable households. Reading them closely, I observed that the ECB seldom uses the word “poverty” directly, but instead frames the issue through terms such as “low-income households,” “income distribution,” and “social cohesion.”</li>
<li>The speeches highlight how inflation disproportionately affects poorer groups, particularly via energy and food prices, while also stressing the need for wage recovery to sustain consumption. At the same time, they caution against excessive wage growth that might fuel inflation. These texts taught me that the ECB treats poverty and inequality as macroeconomic risks to stability rather than as social problems per se.</li>
</ul>
</section>
<section id="question-2" class="level2">
<h2 class="anchored" data-anchor-id="question-2">Question 2 —————————————————–</h2>
<p>Tokenize your documents and pre-process them, removing any “extraneous” content you noticed in closely reading a sample of your documents. What content have you removed and why? Any pre-processing steps from what you saw in class that you consider not to use here?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0) create corpus </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>poverty_corpus <span class="ot">&lt;-</span> <span class="fu">corpus</span>(poverty_speeches, <span class="at">text_field =</span> <span class="st">"contents"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># see the output</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(poverty_corpus,  <span class="at">n =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Corpus consisting of 159 documents, showing 5 documents:

  Text Types Tokens Sentences       date          speakers
 text1  1555   7719       290 2024-03-27   Piero Cipollone
 text2  2080   8396       341 2024-02-16   Isabel Schnabel
 text3  1332   4305       186 2023-12-04 Christine Lagarde
 text4   734   1848        73 2023-10-14 Christine Lagarde
 text5   709   1872        77 2023-09-29 Christine Lagarde
                                                                                        title
 The confidence to act: monetary policy and the role of wages during the disinflation process
                               From laggard to leader? Closing the euro area’s technology gap
                                                                Governance at a turning point
                                                                               IMFC Statement
                                                        Towards an orderly energy transition 
                                                                                                                                                                                                                                                          subtitle
                                                                                                            Speech by Piero Cipollone, Member of the Executive Board of the ECB, at an event organised by the House of the Euro and the Centre for European Reform
                                                                                                                               Inaugural lecture of the EMU Lab by Isabel Schnabel, Member of the Executive Board of the ECB, at the European University Institute
                                                                                                                                                         Speech by Christine Lagarde, President of the ECB, à l’Académie des sciences morales et politiques, Paris
                                                                                                                            Statement by Christine Lagarde, President of the ECB, at the forty-eight meeting of the International Monetary and Financial Committee
 Opening remarks by Christine Lagarde, President of the ECB, at the joint IEA-ECB-EIB High-Level International Conference on “Ensuring an orderly energy transition: Europe’s competitiveness and financial stability in a period of global energy transformation”</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(poverty_corpus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "corpus"    "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(poverty_corpus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 'corpus' Named chr [1:159] "  SPEECH  The confidence to act: monetary policy and the role of wages during the disinflation process   Speech"| __truncated__ ...
 - attr(*, "names")= chr [1:159] "text1" "text2" "text3" "text4" ...
 - attr(*, "docvars")='data.frame': 159 obs. of  7 variables:
  ..$ docname_: chr [1:159] "text1" "text2" "text3" "text4" ...
  ..$ docid_  : Factor w/ 159 levels "text1","text2",..: 1 2 3 4 5 6 7 8 9 10 ...
  ..$ segid_  : int [1:159] 1 1 1 1 1 1 1 1 1 1 ...
  ..$ date    : Date[1:159], format: "2024-03-27" "2024-02-16" ...
  ..$ speakers: chr [1:159] "Piero Cipollone" "Isabel Schnabel" "Christine Lagarde" "Christine Lagarde" ...
  ..$ title   : chr [1:159] "The confidence to act: monetary policy and the role of wages during the disinflation process" "From laggard to leader? Closing the euro area’s technology gap" "Governance at a turning point" "IMFC Statement" ...
  ..$ subtitle: chr [1:159] "Speech by Piero Cipollone, Member of the Executive Board of the ECB, at an event organised by the House of the "| __truncated__ "Inaugural lecture of the EMU Lab by Isabel Schnabel, Member of the Executive Board of the ECB, at the European "| __truncated__ "Speech by Christine Lagarde, President of the ECB, à l’Académie des sciences morales et politiques, Paris" "Statement by Christine Lagarde, President of the ECB, at the forty-eight meeting of the International Monetary "| __truncated__ ...
 - attr(*, "meta")=List of 3
  ..$ system:List of 6
  .. ..$ package-version:Classes 'package_version', 'numeric_version'  hidden list of 1
  .. .. ..$ : int [1:3] 4 3 1
  .. ..$ r-version      :Classes 'R_system_version', 'package_version', 'numeric_version'  hidden list of 1
  .. .. ..$ : int [1:3] 4 4 2
  .. ..$ system         : Named chr [1:3] "Darwin" "arm64" "jenniezhao"
  .. .. ..- attr(*, "names")= chr [1:3] "sysname" "machine" "user"
  .. ..$ directory      : chr "/Users/jenniezhao/Dev/PPOL6081/problem-set-01-2025-JianiZhao0321"
  .. ..$ created        : Date[1:1], format: "2025-09-30"
  .. ..$ source         : chr "data.frame"
  ..$ object:List of 2
  .. ..$ unit   : chr "documents"
  .. ..$ summary:List of 2
  .. .. ..$ hash: chr(0) 
  .. .. ..$ data: NULL
  ..$ user  : list()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) tokenization</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the punctuation, numbers, symbols, and URLs</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>poverty_tokens_raw <span class="ot">&lt;-</span> <span class="fu">tokens</span>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  poverty_corpus,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">remove_punct   =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">remove_numbers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">remove_symbols =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">remove_url     =</span> <span class="cn">TRUE</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#str(poverty_tokens_raw)</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#poverty_speeches$contents[1]</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Lowercase + stopwords + custom "extraneous" terms</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>extraneous_terms <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopwords</span>(<span class="st">"en"</span>),</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"speech"</span>,<span class="st">"slides"</span>,<span class="st">"member"</span>,<span class="st">"executive"</span>,<span class="st">"board"</span>,<span class="st">"president"</span>,<span class="st">"vice"</span>,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"chart"</span>,<span class="st">"figure"</span>,<span class="st">"source"</span>,<span class="st">"note"</span>,<span class="st">"notes"</span>,</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ecb"</span>,<span class="st">"eurostat"</span>,<span class="st">"bce"</span>,<span class="st">"eib"</span>,<span class="st">"iea"</span>,<span class="st">"imf"</span>,<span class="st">"oecd"</span>,</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"http"</span>,<span class="st">"https"</span>,<span class="st">"www"</span>,</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"frankfurt"</span>,<span class="st">"brussels"</span>,<span class="st">"european"</span>,<span class="st">"union"</span>,<span class="st">"eu"</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>poverty_tokens <span class="ot">&lt;-</span> poverty_tokens_raw <span class="sc">%&gt;%</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_tolower</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tokens_remove</span>(extraneous_terms, <span class="at">padding =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) n-grams</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>poverty_tokens_ng <span class="ot">&lt;-</span> <span class="fu">tokens_ngrams</span>(poverty_tokens, <span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) build Document–Feature Matrix(dfm) </span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>dfm_poverty <span class="ot">&lt;-</span> <span class="fu">dfm</span>(poverty_tokens_ng)</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) trim extremes: appear in &lt;5% of docs or &gt;95% of docs</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>dfm_poverty_trim <span class="ot">&lt;-</span> <span class="fu">dfm_trim</span>(</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>  dfm_poverty,</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_docfreq =</span> <span class="fl">0.05</span>,</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_docfreq =</span> <span class="fl">0.95</span>,</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">docfreq_type =</span> <span class="st">"prop"</span>,</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>dfm_trim() changed from 247,972 features (159 documents) to 6,047 features (159 documents)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6) quick inspection</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">topfeatures</span>(dfm_poverty_trim, <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       monetary            euro       inflation            area       financial 
           3320            2883            2662            2558            2525 
monetary_policy       euro_area          growth       countries            rate 
           2522            2387            1994            1620            1517 
          rates             see         central          market        interest 
           1515            1428            1410            1350            1321 
          banks          global            bank          crisis           price 
           1288            1246            1143            1107            1047 
      stability             one         markets             may           first 
           1022             957             954             935             909 
           time          prices             new         effects            real 
            888             865             862             839             823 
         fiscal       economies           years           world        measures 
            823             814             811             803             797 
           risk   international          income          europe              us 
            790             775             772             768             756 
         impact          states           level        policies  interest_rates 
            746             727             718             715             707 
         public         capital           since        increase       important 
            704             700             686             680             668 
         labour           firms          demand          higher          recent 
            665             659             657             651             646 
            low          second           trade      investment            even 
            642             634             627             622             616 
            two           paper            need         example          across 
            614             610             607             602             591 
          lower          sector      households    expectations   central_banks 
            584             580             578             572             569 
        working          credit         however      conditions          future 
            563             561             557             555             555 
           role    central_bank           risks            many            debt 
            550             547             544             543             541 
       national           asset          united               m          change 
            540             532             531             527             523 
           high      structural          system         banking         changes 
            522             521             518             515             514 
        current price_stability             now      particular          shocks 
            512             509             503             502             500 
          large            well            year        evidence        pandemic 
            497             495             492             489             472 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">featnames</span>(dfm_poverty_trim)[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "confidence"   "act"          "monetary"     "role"         "wages"       
 [6] "disinflation" "process"      "event"        "organised"    "house"       
[11] "euro"         "centre"       "reform"       "march"        "pleasure"    
[16] "today"        "recent"       "years"        "area"         "experienced" 
[21] "series"       "demand"       "supply"       "shocks"       "resulted"    
[26] "persistently" "high"         "inflation"    "due"          "imports"     
[31] "hit"          "suffered"     "negative"     "shock"        "acted"       
[36] "external"     "tax"          "income"       "practice"     "initially"   
[41] "absorbed"     "mostly"       "workers"      "form"         "lower"       
[46] "real"         "reversal"     "combined"     "restrictive"  "led"         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>domain_stopwords <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"euro"</span>, <span class="st">"euro_area"</span>, <span class="st">"monetary"</span>, <span class="st">"policy"</span>, <span class="st">"monetary_policy"</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ecb"</span>, <span class="st">"central"</span>, <span class="st">"bank"</span>, <span class="st">"banks"</span>, <span class="st">"european"</span>, <span class="st">"union"</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>dfm_poverty_trim2 <span class="ot">&lt;-</span> <span class="fu">dfm_remove</span>(dfm_poverty_trim, <span class="at">pattern =</span> domain_stopwords)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">topfeatures</span>(dfm_poverty_trim2, <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      inflation            area       financial          growth       countries 
           2662            2558            2525            1994            1620 
           rate           rates             see          market        interest 
           1517            1515            1428            1350            1321 
         global          crisis           price       stability             one 
           1246            1107            1047            1022             957 
        markets             may           first            time          prices 
            954             935             909             888             865 
            new         effects            real          fiscal       economies 
            862             839             823             823             814 
          years           world        measures            risk   international 
            811             803             797             790             775 
         income          europe              us          impact          states 
            772             768             756             746             727 
          level        policies  interest_rates          public         capital 
            718             715             707             704             700 
          since        increase       important          labour           firms 
            686             680             668             665             659 
         demand          higher          recent             low          second 
            657             651             646             642             634 
          trade      investment            even             two           paper 
            627             622             616             614             610 
           need         example          across           lower          sector 
            607             602             591             584             580 
     households    expectations   central_banks         working          credit 
            578             572             569             563             561 
        however      conditions          future            role    central_bank 
            557             555             555             550             547 
          risks            many            debt        national           asset 
            544             543             541             540             532 
         united               m          change            high      structural 
            531             527             523             522             521 
         system         banking         changes         current price_stability 
            518             515             514             512             509 
            now      particular          shocks           large            well 
            503             502             500             497             495 
           year        evidence        pandemic    institutions       potential 
            492             489             472             470             459 
  globalisation             gdp         reforms   united_states           today 
            456             454             452             450             444 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wordcloud</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.textplots)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">textplot_wordcloud</span>(</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  dfm_poverty_trim2,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">random_order =</span> <span class="cn">FALSE</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">rotation =</span> .<span class="dv">25</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_words =</span> <span class="dv">100</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_size =</span> <span class="fl">0.5</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_size =</span> <span class="fl">2.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="problem_set_01_Jiani_files/figure-html/Q2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>I removed two sets of terms at different stages:</li>
<li>At the beginning, I dropped generic stopwords, filler words (like slides, notes), and some institutional names (like IMF, OECD) that don’t carry substantive meaning.</li>
<li>Later, I removed domain-specific stopwords (ECB, monetary, policy, euro, bank) because they appear in almost every document and don’t help discriminate between speeches.</li>
</ul>
</section>
<section id="question-3" class="level2">
<h2 class="anchored" data-anchor-id="question-3">Question 3———————————————</h2>
<p>Using <a href="https://github.com/matthewjdenny/preText">Danny and Spirling’s Pretext</a>, tell me which of the pre-processing steps makes a more substantive difference in the data transformation? Would you keep all these steps or would you follow the PreText recommendations? Use a sample of the data to solve this question.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(quanteda, preText, dplyr)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Run factorial preprocessing (tries different combinations)</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>preproc_docs <span class="ot">&lt;-</span> <span class="fu">factorial_preprocessing</span>(</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  poverty_corpus,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">use_ngrams =</span> <span class="cn">FALSE</span>,         </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">infrequent_term_threshold =</span> <span class="fl">0.2</span>, <span class="co"># drop rare terms</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Preprocessing 159 documents 64 different ways...
Currently working on combination 1 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.021 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 13,576 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 12400 of 13576 total terms that appeared in less than 32 documents.
Currently working on combination 2 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.022 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 13,604 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 12409 of 13604 total terms that appeared in less than 32 documents.
Currently working on combination 3 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.022 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 14,559 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 13326 of 14559 total terms that appeared in less than 32 documents.
Currently working on combination 4 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.023 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 14,587 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 13335 of 14587 total terms that appeared in less than 32 documents.
Currently working on combination 5 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.023 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 13,788 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 12607 of 13788 total terms that appeared in less than 32 documents.
Currently working on combination 6 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.026 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 13,816 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 12616 of 13816 total terms that appeared in less than 32 documents.
Currently working on combination 7 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.024 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 14,771 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 13533 of 14771 total terms that appeared in less than 32 documents.
Currently working on combination 8 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.026 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 14,799 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 13542 of 14799 total terms that appeared in less than 32 documents.
Currently working on combination 9 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.024 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 19,335 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 18024 of 19335 total terms that appeared in less than 32 documents.
Currently working on combination 10 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.026 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 19,363 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 18033 of 19363 total terms that appeared in less than 32 documents.
Currently working on combination 11 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.026 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 20,318 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 18950 of 20318 total terms that appeared in less than 32 documents.
Currently working on combination 12 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.03 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 20,346 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 18959 of 20346 total terms that appeared in less than 32 documents.
Currently working on combination 13 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.031 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 19,335 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 18024 of 19335 total terms that appeared in less than 32 documents.
Currently working on combination 14 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.032 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 19,363 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 18033 of 19363 total terms that appeared in less than 32 documents.
Currently working on combination 15 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.03 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 20,318 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 18950 of 20318 total terms that appeared in less than 32 documents.
Currently working on combination 16 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.032 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 20,346 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 18959 of 20346 total terms that appeared in less than 32 documents.
Currently working on combination 17 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.026 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 13,704 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 12425 of 13704 total terms that appeared in less than 32 documents.
Currently working on combination 18 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.029 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 13,732 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 12434 of 13732 total terms that appeared in less than 32 documents.
Currently working on combination 19 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.028 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 14,687 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 13351 of 14687 total terms that appeared in less than 32 documents.
Currently working on combination 20 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.03 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 14,715 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 13360 of 14715 total terms that appeared in less than 32 documents.
Currently working on combination 21 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.039 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 13,919 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 12635 of 13919 total terms that appeared in less than 32 documents.
Currently working on combination 22 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.043 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 13,947 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 12644 of 13947 total terms that appeared in less than 32 documents.
Currently working on combination 23 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.039 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 14,902 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 13561 of 14902 total terms that appeared in less than 32 documents.
Currently working on combination 24 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.036 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 14,930 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 13570 of 14930 total terms that appeared in less than 32 documents.
Currently working on combination 25 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.032 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 19,485 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 18065 of 19485 total terms that appeared in less than 32 documents.
Currently working on combination 26 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.033 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 19,513 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 18074 of 19513 total terms that appeared in less than 32 documents.
Currently working on combination 27 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.032 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 20,468 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 18991 of 20468 total terms that appeared in less than 32 documents.
Currently working on combination 28 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.045 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 20,496 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 19000 of 20496 total terms that appeared in less than 32 documents.
Currently working on combination 29 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.164 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 19,485 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 18065 of 19485 total terms that appeared in less than 32 documents.
Currently working on combination 30 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.038 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 19,513 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 18074 of 19513 total terms that appeared in less than 32 documents.
Currently working on combination 31 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.038 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 20,468 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 18991 of 20468 total terms that appeared in less than 32 documents.
Currently working on combination 32 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.04 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 20,496 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Removing 19000 of 20496 total terms that appeared in less than 32 documents.
Currently working on combination 33 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.02 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 13,576 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 34 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.034 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 13,604 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 35 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.03 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 14,559 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 36 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.032 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 14,587 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 37 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.023 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 13,788 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 38 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.026 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 13,816 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 39 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.026 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 14,771 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 40 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.028 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 14,799 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 41 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.028 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 19,335 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 42 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.028 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 19,363 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 43 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.026 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 20,318 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 44 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.028 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 20,346 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 45 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.028 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 19,335 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 46 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.031 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 19,363 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 47 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.03 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 20,318 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 48 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.031 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 20,346 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 49 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.027 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 13,704 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 50 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.029 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 13,732 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 51 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.027 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 14,687 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 52 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.029 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 14,715 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 53 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.029 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 13,919 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 54 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.032 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 13,947 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 55 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.032 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 14,902 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 56 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.043 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 14,930 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 57 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.031 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 19,485 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 58 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.033 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 19,513 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 59 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.048 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 20,468 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 60 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.035 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 20,496 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 61 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.043 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 19,485 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 62 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.038 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 19,513 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 63 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.037 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 20,468 sparse dfm.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Currently working on combination 64 of 64 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating a dfm from a tokens object...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...lowercasing</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> ...complete, elapsed time: 0.04 seconds.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Finished constructing a 159 x 20,496 sparse dfm.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run preText</span></span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a>pretext_results <span class="ot">&lt;-</span> <span class="fu">preText</span>(</span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a>  preproc_docs,</span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset_name =</span> <span class="st">"ECB Poverty Speeches"</span>,</span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">distance_method =</span> <span class="st">"cosine"</span>,</span>
<span id="cb349-6"><a href="#cb349-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">num_comparisons =</span> <span class="dv">20</span>,  <span class="co"># how many random comparisons</span></span>
<span id="cb349-7"><a href="#cb349-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span></span>
<span id="cb349-8"><a href="#cb349-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating document distances...
Currently working on dfm 1 of 64 
Complete in: 0.051 seconds...
Currently working on dfm 2 of 64 
Complete in: 0.043 seconds...
Currently working on dfm 3 of 64 
Complete in: 0.028 seconds...
Currently working on dfm 4 of 64 
Complete in: 0.028 seconds...
Currently working on dfm 5 of 64 
Complete in: 0.027 seconds...
Currently working on dfm 6 of 64 
Complete in: 0.028 seconds...
Currently working on dfm 7 of 64 
Complete in: 0.028 seconds...
Currently working on dfm 8 of 64 
Complete in: 0.029 seconds...
Currently working on dfm 9 of 64 
Complete in: 0.025 seconds...
Currently working on dfm 10 of 64 
Complete in: 0.034 seconds...
Currently working on dfm 11 of 64 
Complete in: 0.027 seconds...
Currently working on dfm 12 of 64 
Complete in: 0.029 seconds...
Currently working on dfm 13 of 64 
Complete in: 0.026 seconds...
Currently working on dfm 14 of 64 
Complete in: 0.027 seconds...
Currently working on dfm 15 of 64 
Complete in: 0.027 seconds...
Currently working on dfm 16 of 64 
Complete in: 0.028 seconds...
Currently working on dfm 17 of 64 
Complete in: 0.038 seconds...
Currently working on dfm 18 of 64 
Complete in: 0.032 seconds...
Currently working on dfm 19 of 64 
Complete in: 0.032 seconds...
Currently working on dfm 20 of 64 
Complete in: 0.032 seconds...
Currently working on dfm 21 of 64 
Complete in: 0.031 seconds...
Currently working on dfm 22 of 64 
Complete in: 0.031 seconds...
Currently working on dfm 23 of 64 
Complete in: 0.042 seconds...
Currently working on dfm 24 of 64 
Complete in: 0.032 seconds...
Currently working on dfm 25 of 64 
Complete in: 0.031 seconds...
Currently working on dfm 26 of 64 
Complete in: 0.03 seconds...
Currently working on dfm 27 of 64 
Complete in: 0.031 seconds...
Currently working on dfm 28 of 64 
Complete in: 0.031 seconds...
Currently working on dfm 29 of 64 
Complete in: 0.03 seconds...
Currently working on dfm 30 of 64 
Complete in: 0.031 seconds...
Currently working on dfm 31 of 64 
Complete in: 0.037 seconds...
Currently working on dfm 32 of 64 
Complete in: 0.032 seconds...
Currently working on dfm 33 of 64 
Complete in: 0.042 seconds...
Currently working on dfm 34 of 64 
Complete in: 0.044 seconds...
Currently working on dfm 35 of 64 
Complete in: 0.051 seconds...
Currently working on dfm 36 of 64 
Complete in: 0.047 seconds...
Currently working on dfm 37 of 64 
Complete in: 0.043 seconds...
Currently working on dfm 38 of 64 
Complete in: 0.044 seconds...
Currently working on dfm 39 of 64 
Complete in: 0.053 seconds...
Currently working on dfm 40 of 64 
Complete in: 0.046 seconds...
Currently working on dfm 41 of 64 
Complete in: 0.048 seconds...
Currently working on dfm 42 of 64 
Complete in: 0.058 seconds...
Currently working on dfm 43 of 64 
Complete in: 0.051 seconds...
Currently working on dfm 44 of 64 
Complete in: 0.051 seconds...
Currently working on dfm 45 of 64 
Complete in: 0.056 seconds...
Currently working on dfm 46 of 64 
Complete in: 0.05 seconds...
Currently working on dfm 47 of 64 
Complete in: 0.154 seconds...
Currently working on dfm 48 of 64 
Complete in: 0.054 seconds...
Currently working on dfm 49 of 64 
Complete in: 0.047 seconds...
Currently working on dfm 50 of 64 
Complete in: 0.047 seconds...
Currently working on dfm 51 of 64 
Complete in: 0.048 seconds...
Currently working on dfm 52 of 64 
Complete in: 0.05 seconds...
Currently working on dfm 53 of 64 
Complete in: 0.048 seconds...
Currently working on dfm 54 of 64 
Complete in: 0.048 seconds...
Currently working on dfm 55 of 64 
Complete in: 0.057 seconds...
Currently working on dfm 56 of 64 
Complete in: 0.049 seconds...
Currently working on dfm 57 of 64 
Complete in: 0.052 seconds...
Currently working on dfm 58 of 64 
Complete in: 0.054 seconds...
Currently working on dfm 59 of 64 
Complete in: 0.06 seconds...
Currently working on dfm 60 of 64 
Complete in: 0.071 seconds...
Currently working on dfm 61 of 64 
Complete in: 0.068 seconds...
Currently working on dfm 62 of 64 
Complete in: 0.058 seconds...
Currently working on dfm 63 of 64 
Complete in: 0.058 seconds...
Currently working on dfm 64 of 64 
Complete in: 0.059 seconds...
Generating preText Scores...
Currently working on DFM: 1 of 64 

Complete in: 0.033 seconds...
Currently working on DFM: 2 of 64 

Complete in: 0.034 seconds...
Currently working on DFM: 3 of 64 

Complete in: 0.031 seconds...
Currently working on DFM: 4 of 64 

Complete in: 0.029 seconds...
Currently working on DFM: 5 of 64 

Complete in: 0.033 seconds...
Currently working on DFM: 6 of 64 

Complete in: 0.034 seconds...
Currently working on DFM: 7 of 64 

Complete in: 0.038 seconds...
Currently working on DFM: 8 of 64 

Complete in: 0.029 seconds...
Currently working on DFM: 9 of 64 

Complete in: 0.031 seconds...
Currently working on DFM: 10 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 11 of 64 

Complete in: 0.029 seconds...
Currently working on DFM: 12 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 13 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 14 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 15 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 16 of 64 

Complete in: 0.028 seconds...
Currently working on DFM: 17 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 18 of 64 

Complete in: 0.029 seconds...
Currently working on DFM: 19 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 20 of 64 

Complete in: 0.029 seconds...
Currently working on DFM: 21 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 22 of 64 

Complete in: 0.029 seconds...
Currently working on DFM: 23 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 24 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 25 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 26 of 64 

Complete in: 0.029 seconds...
Currently working on DFM: 27 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 28 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 29 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 30 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 31 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 32 of 64 

Complete in: 0.031 seconds...
Currently working on DFM: 33 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 34 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 35 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 36 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 37 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 38 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 39 of 64 

Complete in: 0.029 seconds...
Currently working on DFM: 40 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 41 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 42 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 43 of 64 

Complete in: 0.029 seconds...
Currently working on DFM: 44 of 64 

Complete in: 0.036 seconds...
Currently working on DFM: 45 of 64 

Complete in: 0.037 seconds...
Currently working on DFM: 46 of 64 

Complete in: 0.036 seconds...
Currently working on DFM: 47 of 64 

Complete in: 0.036 seconds...
Currently working on DFM: 48 of 64 

Complete in: 0.032 seconds...
Currently working on DFM: 49 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 50 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 51 of 64 

Complete in: 0.031 seconds...
Currently working on DFM: 52 of 64 

Complete in: 0.031 seconds...
Currently working on DFM: 53 of 64 

Complete in: 0.029 seconds...
Currently working on DFM: 54 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 55 of 64 

Complete in: 0.031 seconds...
Currently working on DFM: 56 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 57 of 64 

Complete in: 0.037 seconds...
Currently working on DFM: 58 of 64 

Complete in: 0.029 seconds...
Currently working on DFM: 59 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 60 of 64 

Complete in: 0.029 seconds...
Currently working on DFM: 61 of 64 

Complete in: 0.029 seconds...
Currently working on DFM: 62 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 63 of 64 

Complete in: 0.03 seconds...
Currently working on DFM: 64 of 64 
Complete in: 0 seconds...
Generating regression results..
The R^2 for this model is: 0.4192663 
Regression results (negative coefficients imply less risk):
                 Variable Coefficient    SE
1               Intercept       0.153 0.011
2      Remove Punctuation      -0.040 0.008
3          Remove Numbers       0.002 0.008
4               Lowercase       0.003 0.008
5                Stemming      -0.019 0.008
6        Remove Stopwords       0.008 0.008
7 Remove Infrequent Terms      -0.017 0.008
Complete in: 4.755 seconds...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the scores</span></span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a><span class="fu">preText_score_plot</span>(pretext_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_point(ggplot2::aes(x = Variable, y = Coefficient), :
Ignoring unknown parameters: `linewidth`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="problem_set_01_Jiani_files/figure-html/Q3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression coefficients: which steps matter?</span></span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a><span class="fu">regression_coefficient_plot</span>(pretext_results,</span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">remove_intercept =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggplot2::geom_point(ggplot2::aes(y = Variable, x = Coefficient), :
Ignoring unknown parameters: `linewidth`</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="problem_set_01_Jiani_files/figure-html/Q3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>which preprocessing steps matter most? - Among all the cleaning steps, punctuation removal changes ECB speeches the most, followed by stemming and dropping rare words. Stopword removal has some effect, while numbers and lowercasing hardly matter. This suggests we should be cautious with punctuation and stemming, but we can safely lowercase and remove numbers.</p>
<p>Would I keep all the steps? - I would keep basic cleaning (lowercasing, numbers, stopwords), but I would avoid stemming and punctuation removal, since PreText shows they alter the data the most and risk losing important meaning.</p>
</section>
<section id="question-4" class="level2">
<h2 class="anchored" data-anchor-id="question-4">Question 4 ———————————————</h2>
<p>Pick an important source of variation in your data (for example: date, author identity, location, etc.). Subset the data along this dimension, and discuss which words discriminate better each group. You can do this by using TF-IDF, PMI, log(share <span class="math inline">\(word_i\)</span> in group a/share <span class="math inline">\(word_i\)</span> in b), or create a measure similar to Ban’s article.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create dfm grouped by speaker</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>dfm_by_speaker <span class="ot">&lt;-</span> dfm_poverty_trim2 <span class="sc">%&gt;%</span></span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm</span>() <span class="sc">%&gt;%</span></span>
<span id="cb355-4"><a href="#cb355-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dfm_group</span>(<span class="at">groups =</span> <span class="fu">docvars</span>(poverty_corpus, <span class="st">"speakers"</span>))</span>
<span id="cb355-5"><a href="#cb355-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-6"><a href="#cb355-6" aria-hidden="true" tabindex="-1"></a>dfm_by_speaker</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Document-feature matrix of: 22 documents, 6,040 features (55.12% sparse) and 1 docvar.
                          features
docs                       confidence act role wages disinflation process event
  Benoît Cœuré                      8  11   40    24            0      18    12
  Christine Lagarde                11  11   22    23            2      16     5
  Fabio Panetta                     6   7   24    11            1       7     4
  Gertrude Tumpel-Gugerell          4   0    0     0            0       2     0
  Isabel Schnabel                  21  11   41    58            2      20     4
  Jean-Claude Trichet              12   3   53     1            0      44     5
                          features
docs                       organised house centre
  Benoît Cœuré                     8     4      7
  Christine Lagarde                3     1      5
  Fabio Panetta                    4     2      8
  Gertrude Tumpel-Gugerell         0     5      0
  Isabel Schnabel                 15    27      5
  Jean-Claude Trichet              3     5      5
[ reached max_ndoc ... 16 more documents, reached max_nfeat ... 6,030 more features ]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a>dfm_tfidf_speaker <span class="ot">&lt;-</span> <span class="fu">dfm_tfidf</span>(dfm_by_speaker, <span class="at">scheme_tf =</span> <span class="st">"prop"</span>)</span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="co"># look at top features per speaker</span></span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a><span class="fu">topfeatures</span>(dfm_tfidf_speaker[<span class="st">"Christine Lagarde"</span>, ], <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         pandemic             women            energy           climate 
     0.0035454811      0.0010744979      0.0010665320      0.0009627198 
         covid-19             green    climate_change        leadership 
     0.0009124400      0.0008492719      0.0008046558      0.0007499014 
    supply_chains            chains           ukraine         christine 
     0.0007362179      0.0006629881      0.0005996034      0.0005699251 
christine_lagarde        transition        governance           lagarde 
     0.0005699251      0.0005652620      0.0005646722      0.0005641800 
    supranational       series_main      geopolitical  green_transition 
     0.0005486798      0.0005474640      0.0004953246      0.0004908119 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topfeatures</span>(dfm_tfidf_speaker[<span class="st">"Isabel Schnabel"</span>, ], <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           slide         pandemic  slide_left-hand slide_right-hand 
    0.0022586781     0.0022049734     0.0020376693     0.0020067955 
        schnabel        left-hand       right-hand           carbon 
    0.0013930475     0.0008565101     0.0008565101     0.0007547224 
          energy   left-hand_side  right-hand_side         covid-19 
    0.0007446631     0.0006129817     0.0006129817     0.0005623422 
             vol         lockdown           vol_pp               et 
    0.0005462536     0.0005174177     0.0005085504     0.0004729224 
              pp               al            et_al            trust 
    0.0004705219     0.0004676677     0.0004676677     0.0004666966 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">topfeatures</span>(dfm_tfidf_speaker[<span class="st">"Piero Cipollone"</span>, ], <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         percentages       fourth_quarter         observations 
        0.0027897885         0.0020577644         0.0017171644 
    inflation_target          projections             employee 
        0.0017148036         0.0015666406         0.0014683097 
              energy         disinflation   percentage_changes 
        0.0014384778         0.0014141354         0.0013485659 
        calculations   staff_calculations        supply_shocks 
        0.0013316445         0.0013214788         0.0013131257 
         wage_growth        sources_staff    annual_percentage 
        0.0012121161         0.0011720449         0.0011559136 
contributing_factors                staff               latest 
        0.0011559136         0.0011296142         0.0011237268 
          right-hand               fourth 
        0.0010278168         0.0009194129 </code></pre>
</div>
</div>
<ul>
<li>Lagarde uses more political and thematic language (climate, women, governance).</li>
<li>Schnabel uses technical slide-based and climate-related terms.</li>
<li>Cipollone relies on statistical and inflation-related language.</li>
</ul>
</section>
<section id="question-5" class="level2">
<h2 class="anchored" data-anchor-id="question-5">Question 5———————————————</h2>
<p>Create a dictionary (or use a pre-existing dictionary) to measure a topic of interest in your data. It can be anything, sentiment, tone, misinformation, any topic of interest. Label your documents, and visualize the prevalence of your classes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.dictionaries)</span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>data_dictionary_LSD2015</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Dictionary object with 4 key entries.
- [negative]:
  - a lie, abandon*, abas*, abattoir*, abdicat*, aberra*, abhor*, abject*, abnormal*, abolish*, abominab*, abominat*, abrasiv*, absent*, abstrus*, absurd*, abus*, accident*, accost*, accursed* [ ... and 2,838 more ]
- [positive]:
  - ability*, abound*, absolv*, absorbent*, absorption*, abundanc*, abundant*, acced*, accentuat*, accept*, accessib*, acclaim*, acclamation*, accolad*, accommodat*, accomplish*, accord, accordan*, accorded*, accords [ ... and 1,689 more ]
- [neg_positive]:
  - best not, better not, no damag*, no no, not ability*, not able, not abound*, not absolv*, not absorbent*, not absorption*, not abundanc*, not abundant*, not acced*, not accentuat*, not accept*, not accessib*, not acclaim*, not acclamation*, not accolad*, not accommodat* [ ... and 1,701 more ]
- [neg_negative]:
  - not a lie, not abandon*, not abas*, not abattoir*, not abdicat*, not aberra*, not abhor*, not abject*, not abnormal*, not abolish*, not abominab*, not abominat*, not abrasiv*, not absent*, not abstrus*, not absurd*, not abus*, not accident*, not accost*, not accursed* [ ... and 2,840 more ]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply dictionary</span></span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a>dfm_sentiment <span class="ot">&lt;-</span> <span class="fu">dfm_lookup</span>(dfm_poverty_trim2, <span class="at">dictionary =</span> data_dictionary_LSD2015)</span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect first rows</span></span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dfm_sentiment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Document-feature matrix of: 6 documents, 4 features (50.00% sparse) and 4 docvars.
       features
docs    negative positive neg_positive neg_negative
  text1      145      191            0            0
  text2      141      284            0            0
  text3      115      237            0            0
  text4       69      105            0            0
  text5       55       69            0            0
  text6       57      132            0            0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate by year</span></span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a><span class="fu">docvars</span>(poverty_corpus, <span class="st">"year"</span>) <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">year</span>(<span class="fu">docvars</span>(poverty_corpus, <span class="st">"date"</span>))</span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a>sent_by_year <span class="ot">&lt;-</span> <span class="fu">convert</span>(dfm_sentiment, <span class="at">to=</span><span class="st">"data.frame"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">docvars</span>(poverty_corpus, <span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb367-6"><a href="#cb367-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb367-7"><a href="#cb367-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(positive, negative), sum))</span>
<span id="cb367-8"><a href="#cb367-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-9"><a href="#cb367-9" aria-hidden="true" tabindex="-1"></a>sent_by_year</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 3
    year positive negative
   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1  1997      213       56
 2  1998      192       36
 3  2001      586      227
 4  2003      457      147
 5  2004      561      170
 6  2005      394      250
 7  2006      311      200
 8  2007     2052      731
 9  2008     1035      483
10  2010     1868     1268
# ℹ 14 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a>sent_by_year_long <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(sent_by_year, <span class="at">cols=</span><span class="fu">c</span>(positive, negative),</span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">names_to=</span><span class="st">"sentiment"</span>, <span class="at">values_to=</span><span class="st">"count"</span>)</span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sent_by_year_long, <span class="fu">aes</span>(<span class="at">x=</span>year, <span class="at">y=</span>count, <span class="at">fill=</span>sentiment)) <span class="sc">+</span></span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb369-6"><a href="#cb369-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb369-7"><a href="#cb369-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Positive vs Negative Tone in ECB Poverty Speeches"</span>,</span>
<span id="cb369-8"><a href="#cb369-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Year"</span>, <span class="at">y=</span><span class="st">"Word Counts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="problem_set_01_Jiani_files/figure-html/Q5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="question-6" class="level2">
<h2 class="anchored" data-anchor-id="question-6">Question 6———————————————</h2>
<p>Pick some documents (at least 10 for each class) that are exemplar (high probability) of being for each class of your dictionary. Read these documents. Now let’s try to augment a little your classifier.</p>
<section id="question-6.1--" class="level3">
<h3 class="anchored" data-anchor-id="question-6.1--">Question 6.1 —————————————————-</h3>
<p>Using cosine similarity, grab the closest 10 documents to each reference document you read before. Read those. How well does the cosine similarity work? Try with another measure of distance. Anything interesting there?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda.textstats)</span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Build TF-IDF dfm</span></span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a>dfm_tfidf_speeches <span class="ot">&lt;-</span> <span class="fu">dfm_tfidf</span>(dfm_poverty_trim2, <span class="at">scheme_tf =</span> <span class="st">"prop"</span>)</span>
<span id="cb370-5"><a href="#cb370-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-6"><a href="#cb370-6" aria-hidden="true" tabindex="-1"></a><span class="co"># cosine similarity</span></span>
<span id="cb370-7"><a href="#cb370-7" aria-hidden="true" tabindex="-1"></a>simil_speeches <span class="ot">&lt;-</span> <span class="fu">textstat_simil</span>(dfm_tfidf_speeches,  </span>
<span id="cb370-8"><a href="#cb370-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">margin =</span> <span class="st">"documents"</span>,</span>
<span id="cb370-9"><a href="#cb370-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">method =</span> <span class="st">"cosine"</span>)</span>
<span id="cb370-10"><a href="#cb370-10" aria-hidden="true" tabindex="-1"></a>                                 </span>
<span id="cb370-11"><a href="#cb370-11" aria-hidden="true" tabindex="-1"></a>sim_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(simil_speeches)</span>
<span id="cb370-12"><a href="#cb370-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-13"><a href="#cb370-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels (speaker + date to avoid duplicates)</span></span>
<span id="cb370-14"><a href="#cb370-14" aria-hidden="true" tabindex="-1"></a>doc_ids <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">docvars</span>(poverty_corpus, <span class="st">"speakers"</span>),</span>
<span id="cb370-15"><a href="#cb370-15" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">docvars</span>(poverty_corpus, <span class="st">"date"</span>),</span>
<span id="cb370-16"><a href="#cb370-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb370-17"><a href="#cb370-17" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(sim_matrix) <span class="ot">&lt;-</span> doc_ids</span>
<span id="cb370-18"><a href="#cb370-18" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sim_matrix) <span class="ot">&lt;-</span> doc_ids</span>
<span id="cb370-19"><a href="#cb370-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-20"><a href="#cb370-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Isabel Schnabel cosine neighbors</span></span>
<span id="cb370-21"><a href="#cb370-21" aria-hidden="true" tabindex="-1"></a>cosine_neighbors <span class="ot">&lt;-</span> <span class="fu">sort</span>(sim_matrix[<span class="fu">grep</span>(<span class="st">"Isabel Schnabel"</span>, <span class="fu">rownames</span>(sim_matrix))[<span class="dv">1</span>], ],</span>
<span id="cb370-22"><a href="#cb370-22" aria-hidden="true" tabindex="-1"></a>                         <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>] </span>
<span id="cb370-23"><a href="#cb370-23" aria-hidden="true" tabindex="-1"></a>                         </span>
<span id="cb370-24"><a href="#cb370-24" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Euclidean Distance ---</span></span>
<span id="cb370-25"><a href="#cb370-25" aria-hidden="true" tabindex="-1"></a>dist_speeches_euc <span class="ot">&lt;-</span> <span class="fu">textstat_dist</span>(dfm_tfidf_speeches, <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb370-26"><a href="#cb370-26" aria-hidden="true" tabindex="-1"></a>dist_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dist_speeches_euc)</span>
<span id="cb370-27"><a href="#cb370-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-28"><a href="#cb370-28" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(dist_matrix) <span class="ot">&lt;-</span> doc_ids</span>
<span id="cb370-29"><a href="#cb370-29" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dist_matrix) <span class="ot">&lt;-</span> doc_ids</span>
<span id="cb370-30"><a href="#cb370-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-31"><a href="#cb370-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Isabel Schnabel Euclidean neighbors</span></span>
<span id="cb370-32"><a href="#cb370-32" aria-hidden="true" tabindex="-1"></a>euclidean_neighbors <span class="ot">&lt;-</span> <span class="fu">sort</span>(dist_matrix[<span class="fu">grep</span>(<span class="st">"Isabel Schnabel"</span>, <span class="fu">rownames</span>(dist_matrix))[<span class="dv">1</span>], ])[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb370-33"><a href="#cb370-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-34"><a href="#cb370-34" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Side-by-side comparison ---</span></span>
<span id="cb370-35"><a href="#cb370-35" aria-hidden="true" tabindex="-1"></a>cosine_neighbors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Isabel Schnabel_2020-02-11 Isabel Schnabel_2023-03-02 
                 0.3793923                  0.3236895 
Isabel Schnabel_2022-05-11    Benoît Cœuré_2019-05-16 
                 0.3228097                  0.3187021 
   Mario Draghi_2016-11-30 Luis de Guindos_2019-09-07 
                 0.3161847                  0.3049992 
Isabel Schnabel_2022-09-30 Isabel Schnabel_2021-11-09 
                 0.3030078                  0.2991635 
Isabel Schnabel_2022-02-24 Isabel Schnabel_2020-11-24 
                 0.2933503                  0.2845744 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a>euclidean_neighbors    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Isabel Schnabel_2024-02-16    Vítor Constâncio_2014-04-10 
                    0.00000000                     0.02258282 
Jean-Claude Trichet_2011-08-27        Benoît Cœuré_2019-12-03 
                    0.02303161                     0.02318336 
       Mario Draghi_2019-10-01    Vítor Constâncio_2010-12-07 
                    0.02318654                     0.02337332 
    Isabel Schnabel_2021-11-09     Isabel Schnabel_2020-11-24 
                    0.02361190                     0.02370081 
    Isabel Schnabel_2020-02-11      Philip R. Lane_2022-10-11 
                    0.02411977                     0.02418250 </code></pre>
</div>
</div>
<ul>
<li><p>Using cosine similarity, Isabel Schnabel’s speeches cluster mainly with her own other speeches, plus a few from Draghi and Cœuré. This makes sense because cosine captures proportional word use and is length-invariant, so it highlights consistent style and topical focus.</p></li>
<li><p>Using Euclidean distance, her closest neighbors include Philip Lane and Vítor Constâncio. Euclidean is more sensitive to document length and raw word counts, so it groups speeches that are similar in size and density, even if the proportions differ.</p></li>
</ul>
</section>
<section id="question-6.2-" class="level3">
<h3 class="anchored" data-anchor-id="question-6.2-">Question 6.2—————————————————-</h3>
<p>Now, check qualitative these documents. Take a look at the top features, keyword in Context, higher TF-IDF. Would you change anything in your dictionary now that you looked in these documents?</p>
<ul>
<li>ECB speeches rarely use “poverty” explicitly. They frame it via inequality, wages, employment, and social cohesion. Updating your dictionary makes it better aligned with ECB’s discourse style, ensuring you capture more substantively relevant documents.</li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>